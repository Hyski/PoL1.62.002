#include "logicdefs.h"
#include "BaseBox.h"
#include "DirtyLinks.h"

//=====================================================================================//
//                                 BaseBox::BaseBox()                                  //
//=====================================================================================//
BaseBox::BaseBox(const rid_t& rid)
:	m_info(0)
{
	if(rid.size()) m_info = new BoxInfo(rid);
}

//=====================================================================================//
//                                 BaseBox::~BaseBox()                                 //
//=====================================================================================//
BaseBox::~BaseBox()
{
	delete m_info;
}

//=====================================================================================//
//                        const rid_t& BaseBox::GetRID() const                         //
//=====================================================================================//
const rid_t& BaseBox::GetRID() const
{
	return GetInfo()->GetName();
}

//=====================================================================================//
//                            DataBox* BaseBox::Cast2Info()                            //
//=====================================================================================//
DataBox* BaseBox::Cast2Info()
{
	return 0;
}

//=====================================================================================//
//                           StoreBox* BaseBox::Cast2Store()                           //
//=====================================================================================//
StoreBox* BaseBox::Cast2Store()
{
	return 0;
}

//=====================================================================================//
//                            void BaseBox::MakeSaveLoad()                             //
//=====================================================================================//
void BaseBox::MakeSaveLoad(SavSlot& slot)
{
	if(slot.IsSaving())
	{
		slot << GetRID();
	}
	else
	{
		rid_t rid;
		slot >> rid;    

		m_info = new BoxInfo(rid);
	}
}

//=====================================================================================//
//                       const BoxInfo* BaseBox::GetInfo() const                       //
//=====================================================================================//
const BoxInfo* BaseBox::GetInfo() const
{
	return m_info;
}


